---
layout: post
read_time: true
show_date: true
title: "那么，什么是神经网络？"
date: 2021-04-02
img: posts/20210402/post7-header.webp
tags: [神经网络, 机器学习, 人工智能]
category: theory
author: 阿曼多·梅内斯（Armando Maynez）
description: "用通俗易懂的方式解释：什么是神经网络。"
---
如今，科技无处不在，以至于读到有关人工智能的新闻已经变得司空见惯。只需快速浏览一下今天的头条新闻，我就能看到：
- [这项强大的人工智能技术在谷歌引发了冲突，并在科技界引发了激烈辩论。](https://www.morningbrew.com/emerging-tech/stories/2021/03/29/one-biggest-advancements-ai-also-sparked-fierce-debate-heres?utm_source=morning_brew)
- [人工智能驱动的公司如何躲过新冠疫情造成的最严重破坏](https://fortune.com/2021/04/02/ai-forecasting-supply-chain-factories-caterpillar-agco/)
- [人工智能技术检测出 “定时炸弹” 般的动脉状况](https://www.mobihealthnews.com/news/emea/ai-technology-detects-ticking-time-bomb-arteries)
- [人工智能在药物发现领域开始不负盛名](https://www.genengnews.com/insights/ai-in-drug-discovery-starts-to-live-up-to-the-hype/)
- [五角大楼寻求商业解决方案，为人工智能准备数据](https://www.c4isrnet.com/artificial-intelligence/2021/04/02/pentagon-seeks-commercial-solutions-to-get-its-data-ready-for-ai/)

这些新闻标题涵盖了商业、制造业、供应链、医学和生物技术，甚至国防等领域。毫无疑问，人工智能领域的进步，尤其是机器学习和深度神经网络，已经渗透到我们的日常生活中，并且会一直存在。但是，当我们说 “人工智能” 时，普通大众知道我们在谈论什么吗？我猜大多数人能正确地想象出一种计算机算法，也许更有想象力的人会想到一种物理机器、一个先进的计算机实体，甚至是一个机器人，它在我们提供的每个用例中都能自我变得更智能。而且大多数人是对的，当提到 “人工智能” 时，它确实是由计算机运行的一种算法，而这也是他们知识的边界所在。

人们说，学习某样东西的最好方法是尝试去解释它，所以作为一个个人练习，我将尝试用 “像给五岁小孩解释一样”（**E**xplain it **L**ike **I** am **5**，简称ELI5）的方式来解释什么是神经网络。

让我们从一点历史开始讲起。如今，人类已经对智能机器的概念进行了一段时间的探索，甚至有人说人工智能的概念是由古希腊人提出的([来源](https://www.thinkautomation.com/bots-and-ai/a-history-of-automation-the-rise-of-robots-and-ai/))。在历史上，人们进行了多次设计 “智能” 机器的尝试，其中一个著名的例子是查尔斯·巴贝奇（Charles Babbage）在1837年创造的 “分析机”：

![分析机](./assets/img/posts/20210402/post7-analytical-engine.jpg)
<small>查尔斯·巴贝奇的分析机 - 1837年</small>

然后，在上世纪中叶，通过尝试创建一个人类大脑工作原理的模型，神经网络诞生了。大约在那个时候，康奈尔大学的弗兰克·罗森布拉特（Frank Rosenblatt）试图理解普通家蝇眼睛中存在的简单决策系统，他提出了[感知机](./single-neuron-perceptron.html)的概念，这是一个非常简单的系统，它通过基本的数学运算处理某些输入并产生一个输出。

![一个感知机](./assets/img/posts/20210125/Perceptron.png)

为了说明这一点，假设家蝇的大脑是一个感知机，它的输入是其眼睛中多个细胞产生的任何值。当眼睛细胞检测到 “某物” 时，它的输出将是1，如果什么都没有检测到则输出为0。然后，所有这些输入的组合可以由感知机（苍蝇的大脑）进行处理，输出是一个简单的0或1值。如果是1，那么大脑就会告诉苍蝇逃跑；如果是0，则意味着待在原地是安全的。

![一只家蝇的眼睛](./assets/img/posts/20210402/post7-housefly-eye.jpg)

然后我们可以想象，如果苍蝇的许多眼睛细胞产生1，这意味着一个物体非常接近，因此感知机将计算出1，是时候逃跑了。

![苍蝇的视野](./assets/img/posts/20210402/post7-fly-vision.jpg)

感知机只是一种数学运算，它将某些输入值与预设的 “参数”（称为权重）相乘，然后将相乘的结果相加，以生成一个值。

然后，神奇的火花被点燃了，感知机的参数（权重）可以通过最小化特定观测的已知结果与感知机实际计算结果之间的差异这个过程来 “学习”。我们把这个学习过程称为 **训练神经网络**。

<tweet>这个想法非常强大，以至于即使在今天，它仍然是我们所说的人工智能的基本组成部分之一。</tweet>

基于此，我将尝试解释这个简单的概念如何能有如此多样化的应用，比如自然语言处理（想想亚马逊的Alexa）、像从CT扫描进行医学诊断的图像识别、自动驾驶汽车等等。

一个基本的神经网络是由不同排列方式的感知机组合而成的，因此感知机从 “苍蝇大脑” 降级为了 “网络神经元”。
![多层感知机](./assets/img/posts/20210402/post7-multilayer-perceptron.png)

神经网络有不同的组成部分，其基本形式包括：
- 输入
- 隐藏层
- 输出

![神经网络组件](./assets/img/posts/20210228/nnet_flow.gif)

### 输入

神经网络的输入本质上只是数字，因此任何可以转换为数字的东西都可以成为输入。文本中的字母、图像中的像素、声波中的频率、传感器的值等等，这些都是不同的东西，当它们被转换为数值时，就可以作为神经网络的输入。这就是神经网络应用如此多样化的原因之一。

输入的数量可以根据手头的任务按需而定，从用于教神经网络如何玩井字棋的大约9个输入，到自动驾驶汽车从摄像头获取的数千个像素。由于感知机的输入需要是单个值，例如，如果选择一个彩色像素作为输入，很可能它会被分解为三个不同的值，即它的红色、绿色和蓝色分量，因此每个像素将成为神经网络的3个不同输入。

### 隐藏层

神经网络中的 “层” 只是一组感知机，它们对输入执行完全相同的数学运算并产生一个输出。关键在于，它们中的每一个都有不同的权重（参数），因此对于给定的输入，它们的输出会有所不同。层有很多种类型，其中最典型的是 “全连接层”（dense layer），也就是说所有的输入都连接到所有的神经元（单个感知机），并且如前所述，这些连接中的每一个都有一个与之相关的权重，这样每个神经元执行的操作就是所有输入的简单加权和。

![全连接层](./assets/img/posts/20210402/post7-dense-layers.png)

然后，隐藏层通常连接到另一个全连接层，它们的连接意味着第一层中每个神经元的输出实际上都被视为下一层的输入，并且因此与下一层的每个神经元相连。

一个神经网络可以有一层，也可以有我们能想到的尽可能多的层，层的数量完全取决于我们在想要解决的特定问题上所积累的经验。

隐藏层的另一个关键参数是它所拥有的神经元数量，同样，我们需要依靠经验来确定对于给定的问题需要多少个神经元。我见过的网络中，神经元的数量从几个到数千个不等。当然，每个隐藏层可以有我们想要的任意数量的神经元，所以组合的数量是非常庞大的。

层的数量、它们的类型以及每个层拥有的神经元数量，这些我们称之为 *网络拓扑结构*（包括输入和输出的数量）。

### 输出

在这个链条的最后，还有另一层（其行为就像一个隐藏层），但它有一个特殊之处，即它是最后一层，因此它计算出的任何值都将是整个网络的输出值。网络的输出数量取决于我们想要解决的问题。它可以像只有一个输出那么简单，其值代表一个动作的概率（就像家蝇的逃跑反应那样）；也可以有很多输出，例如，如果我们的网络试图区分动物的图像，那么对于每个动物物种都可能有一个输出，并且输出将表示网络对特定图像属于相应物种的置信程度。

正如我们所说，神经网络只是一组单个的神经元，它们对某些输入在一系列层中进行基本的数学运算，最终生成一个输出。然后，这个神经元的网络会根据已知输入案例的某些输出值进行 “训练”；一旦它学会了，它就可以处理新的输入，即它从未见过的值，并且能得出令人惊讶的准确结果。

神经网络解决的许多问题，当然也可以通过其他算法来解决。然而，由于神经网络的核心是非常基本的运算，一旦经过训练，它们的效率极高，因此能够更快、更经济地产生结果。

关于一个简单的神经网络是如何运行的，还有一些更多的细节，我有意省略了，以便使这个解释尽可能简单。比如偏置、激活函数以及学习背后的数学原理、反向传播算法等，我会在更深入的文章中介绍。我也会写（也许是一系列文章）关于更复杂的拓扑结构，这些结构结合了不同类型的层和除了感知机之外的其他构建模块。

![Alexa识别语音](./assets/img/posts/20210402/post7-alexa.png)

像 “Alexa” 这样的东西要稍微复杂一些，但它们的工作原理完全相同。让我们以要求 “Alexa” 在Spotify上播放一首歌为例来分解一下这个过程。Alexa使用了几个不同的神经网络来完成这个任务：

#### 1. 语音识别

作为基本输入，我们有我们的语音指令：“Alexa，播放范·海伦（Van Halen）的歌”。对于我们人类来说，处理这个指令可能看起来相当简单，但对于机器来说，理解语音是一项极其困难的任务。像每个人独特的声音音色、语调、意图以及人类口语中的许多其他细微差别，使得传统算法在处理这个问题时遇到了很大的困难。在我们简化的例子中，假设我们使用一个神经网络将我们说出的语音转换为计算机更熟悉学习的文本字符。

#### 2. 理解我们的意思（自然语言理解）

一旦前面的网络成功地将我们说出的单词转换为文本，接下来就面临着更困难的任务，即理解我们所说的话的含义。像上下文、语调以及非语言交流等我们人类认为理所当然的东西，以一种非常微妙但强大的方式帮助赋予我们的话语意义，而机器则必须依靠少得多的信息来正确理解我们的意思。它必须正确识别我们句子的意图以及我们所指的主题或实体。

![Alexa的自然语言理解](./assets/img/posts/20210402/post7-alexa-natural-lang.png)

神经网络必须识别出它接收到了一个指令（通过识别它的名字）、指令的内容（“播放音乐”）以及我们的选择（“范·海伦”）。并且它通过前面描述的简单数学运算来做到这一点。当然，所涉及的网络相当复杂，有不同类型的神经元和连接类型，但基本原理仍然不变。

#### 3. 回复我们

一旦Alexa理解了我们的意思，它就会继续执行它所解释的指令的动作，然后反过来使用自然语言回复我们。这是通过一种称为语音合成的技术来实现的。像单词和音素的音高、持续时间和强度等，都是根据Alexa要回复我们的内容的 “含义” 来选择的，例如 “正在Spotify上播放范·海伦的歌曲”，听起来非常自然。而所有这些都是通过神经网络执行许多简单的数学运算来完成的。

![Alexa的步骤](./assets/img/posts/20210402/post7-alexa-steps.png)
<small>尽管看起来相当复杂，但人工智能理解我们的过程可以归结为简单的数学运算</small>

当然，亚马逊的Alexa神经网络经过了大量的训练才达到了现在的水平，其美妙之处在于，一旦经过训练，它们只需进行一些数学运算就能发挥神奇的作用。

如前所述，我将继续写关于神经网络的基础知识，这个系列的下一篇文章将更深入地探讨基本神经网络背后的数学原理。 